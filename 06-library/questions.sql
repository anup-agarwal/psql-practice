-- ============================
-- LIBRARY DATASET â€” PRACTICE QUESTIONS
-- ============================

-- Q1. List all members with their membership type and city.


-- Q2. List all books with their author name and genre name.


-- Q3. List all book loans with member name, book title, and loan status.


-- Q4. For each genre, show how many books belong to it.


-- Q5. For each author, show the total number of books written.


-- Q6. List all books that have NO available copies (available_copies = 0).


-- Q7. List all members who have NEVER borrowed any book.


-- Q8. List all book loans that are currently overdue (status = 'overdue').


-- Q9. For each member, show the total number of active loans.


-- Q10. Show the TOP 3 most expensive books.


-- Q11. List all books published before 2000.


-- Q12. List all book loans with member name, book title, and fine amount.


-- Q13. List all authors who have NO books in the library.


-- Q14. For each membership type, show how many members belong to it.


-- Q15. List all members who have active loans but have fines (fine_amount > 0).


-- Q16. Show all genres along with the average price of books in each genre.


-- Q17. List all books that have been borrowed but NEVER returned
--      (loans with return_date IS NULL and status != 'returned').


-- Q18. For each author, show the average price of their books.


-- Q19. List all members who have borrowed books from the 'Fiction' genre.


-- Q20. Using a CTE:
--      Step 1: Calculate total fines per member.
--      Step 2: Show only members with total fines > 50.


-- Q21. List all books that have been borrowed more than once.


-- Q22. Show the author with the most books in the library.


-- Q23. List all members who have borrowed books but have NEVER returned any on time
--      (all their returned loans have fine_amount > 0).


-- Q24. For each loan status, show how many loans are in that status.


-- Q25. List all books that are currently available but have NEVER been borrowed.

